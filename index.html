<html>
    <head>
        <title>APIFetcher-v1.0.0</title>
	    <style>body{ font-size : large }</style>
    </head>
    <body>
        
        <form action="#">
            <select name="apiname" id="apiname">
                <option value="default" selected> Choose API</option>
                <option value="payfone"> payfone </option>
                <option value="accountf">accountf</option>
                <option value="kyc">kyc</option>
                <option value="document">document</option>
            </select>
            <select name="apienv" id="apienv">
                <option value="default" selected>Choose Environment</option>
                <option value="dev">dev</option>
                <option value="sit">sit</option>
                <option value="oat">oat</option>
                <option value="vpt">vpt</option>
                <option value="lcp">lcp</option>
                <option value="prod">prod</option>
            </select>
            <button name="apisubmit" type="submit" onclick="loadData()">Fetch Details</button>
        </form>

        <textarea name="apijson" id="apijson">
            Your API Details show here.
        </textarea>

        <footer style="text-align: center; font-size: small;">
            Author: Mayank Singh Rathore
        </footer>
    </body>
    <script> 
        //fetching data from apis.json and storing it in an array
        
        function loadData(){
	    var apiArray = []; 
	    var newArray = []; 
		
	    var apiNameSelect = document.getElementById("apiname");
	    var apiName = apiNameSelect.options[apiNameSelect.selectedIndex];
		
            var apiEnvSelect = document.getElementById("apienv");
            var apiEnv = apiEnvSelect.options[apiEnvSelect.selectedIndex];
		
            fetch("data/apis.json")
                .then(response => {
                return response.json();
            })
                //.then(jsondata => console.log(jsondata))
                .then(jsondata => {

                for(var i in jsondata)
                    apiArray.push([i, jsondata [i]]); 
		    		    
		    const n = apiArray.length; 
		    console.log(n); 
		    
		    for(var i = 0; i < n; i++){
			    for( var j = 1; j < 2; j++){
				    console.log(apiArray[i][j].apiname); 
				    console.log(apiArray[i][j].env); 
				    
				    if(apiArray[i][j].apiname == apiName.text && apiArray[i][j].env == apiEnv.text){
					    document.getElementById("apijson").value += apiArray[i][j]; 
				    }
			    }
		    }

		    /*
		    //object
		    apiArray.forEach(api => {
			    api.forEach(element => {
				    console.log(Object.getPrototypeOf(element));
				    console.log(element.toString());				    
			    });
		    });		    
		    let result = apiArray.forEach(api => {api.find(data => data.env ==="sit")});
		    console.log(result); 
		    */
		    
         
            });   
        }
    	  
	    /*
        function findAPI(arr){		
		var apiNameSelect = document.getElementById("apiname");
		var apiName = apiNameSelect.options[apiNameSelect.selectedIndex];
		
		var apiEnvSelect = document.getElementById("apienv");
		var apiEnv = apiEnvSelect.options[apiEnvSelect.selectedIndex];
		
		console.log(apiName.text);
		console.log(apiEnv.text); 

		var newArray = arr.filter(function (el) {
			return el.apiname ==  apiName && el.env == apiEnv;
		});	
		console.log(newArray); 
		document.getElementById("apijson").value = newArray; 
	} */
	    
    </script>
</html>
